import { Construct } from "constructs";
import { AzAPIBase, IAzAPIBaseProps } from "./core-azapi";

/**
 * Interface representing the properties for instance pool configuration.
 *
 * @extends IAzAPIBaseProps Base properties including name, location, and tags.
 */
export interface SqlServersVulnerabilityassessmentsProps extends IAzAPIBaseProps {
/**
   * In Bicep, you can specify the parent resource for a child resource. You only need to add this property when the child resource is declared outside of the parent resource.For more information, seeChild resource outside parent resource.
   */
readonly parent?: Symbolic name for resource of type:servers;

/**
   * The recurring scans settings
   */
readonly recurringScans?: VulnerabilityAssessmentRecurringScansProperties;

/**
   * Specifies the identifier key of the storage account for vulnerability assessment scan results. If 'StorageContainerSasKey' isn't specified, storageAccountAccessKey is required. Applies only if the storage account is not behind a Vnet or a firewall
   */
readonly storageAccountAccessKey?: string;

/**
   * A blob storage container path to hold the scan results (e.g.https://myStorage.blob.core.windows.net/VaScans/).
   */
readonly storageContainerPath: string;

/**
   * A shared access signature (SAS Key) that has write access to the blob container specified in 'storageContainerPath' parameter. If 'storageAccountAccessKey' isn't specified, StorageContainerSasKey is required. Applies only if the storage account is not behind a Vnet or a firewall
   */
readonly storageContainerSasKey?: string;

/**
   * Specifies an array of e-mail addresses to which the scan notification is sent.
   */
readonly emails?: string[];

/**
   * Specifies that the schedule scan notification will be is sent to the subscription administrators.
   */
readonly emailSubscriptionAdmins?: bool;

/**
   * Recurring scans state.
   */
readonly isEnabled?: bool;
}

/**
 * SqlServersVulnerabilityassessments resource
 */
export class SqlServersVulnerabilityassessments extends AzAPIBase {
  constructor(scope: Construct, id: string, props: SqlServersVulnerabilityassessmentsProps) {
    super(scope, id, props);
  }

  protected getResourceType(): string {
    return "Microsoft.Sql/servers/vulnerabilityAssessments@2022-05-01-preview";
  }

  protected getResourceBody(props: SqlServersVulnerabilityassessmentsProps): string {
    return JSON.stringify(
        {properties: {recurringScans: {emails: ["string"], emailSubscriptionAdmins: "${bool}", isEnabled: "${bool}"}, storageAccountAccessKey: "string", storageContainerPath: "string", storageContainerSasKey: "string"}}
    );
  }
}
